<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:image" content="URL to the image you want in the preview, LinkedIn recommends a 1.91:1 ratio (1200x627px)" />
    <meta property="og:description" content="This should be a very short description" />
    <meta name="twitter:card" content="summary || summary_large_image || player || app" />
    <meta name="twitter:creator" content="@joeldombek" />

    <title>VERIFY CREDENTIALS üóπ</title>

    <link rel="shortcut icon" href="https://raw.githubusercontent.com/joeldom/asset/main/favicon.ico" rel="icon" type="image/x-icon">
    <link rel="icon shortcut" href="https://raw.githubusercontent.com/joeldom/asset/main/favicon/64x64.png" sizes="64x64" />
    <link rel="icon shortcut" href="https://raw.githubusercontent.com/joeldom/asset/main/favicon/128x128.png" sizes="128x128" />
    <link rel="icon shortcut" href="https://raw.githubusercontent.com/joeldom/asset/main/favicon/192x192.png" sizes="192x192" />
    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/joeldom/asset/main/favicon/76x76.png" sizes="76x76" />
    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/joeldom/asset/main/favicon/120x120.png" sizes="120x120" />
    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/joeldom/asset/main/favicon/152x152.png" sizes="152x152" />
    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/joeldom/asset/main/favicon/180x180.png" sizes="180x180" />

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://joeldom.github.io/redesign/greybox/css/coma.css" rel="stylesheet">
    <!-- <link href="../../redesign/greybox/css/coma.css" rel="stylesheet"> -->
    <link href="../css/login.css" rel="stylesheet">
    <link href="../css/warning.css" rel="stylesheet">

</head>

<body id="login">
    <div class="login">
        <div class="verify">
            <img class="" src="https://raw.githubusercontent.com/joeldom/asset/main/chip-logo.png" width="52px" height="52px" />
            <p class="mt-4">Login</p>
        </div>
        <div class="password-form">
            <form id="loginForm">
                <!-- <img src="https://raw.githubusercontent.com/joeldom/asset/main/chip-logo.png" width="52px" /> -->
                <input type="password" id="password" placeholder="Enter your password">
                <button type="submit" id="submitBtn">Confirm</button>
            </form>

            <!-- Snackbar (Bootstrap Toast) -->
            <div id="snackbar" class="toast position-fixed bottom-0 end-0 p-3" role="alert" aria-live="assertive" aria-atomic="true" style="display: none;">
                <div class="toast-header">
                    <strong class="me-auto">Alert</strong>
                    <small></small>
                    <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
                </div>
                <div class="toast-body" id="snackbarMessage"></div>
            </div>
        </div>
    </div>
    <p class="omega"><a href="https://joeldom.github.io/redesign/">Joel Dombek</a> ¬© X.X.MMXXIV <a href="https://joeldom.github.io/redesign/sandbox/#login">v1</a></p>
    <!-- <img class="verify mt-5" src="https://raw.githubusercontent.com/joeldom/asset/main/chip-logo.png" width="52px" /> -->

    <!-- Bootstrap JS and dependencies [] TODO add locally-->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>

    <script>
        // PASSWORD [X]
        let storedPassword = "COMPANY_NAME";
        let snackbar = new bootstrap.Toast(document.getElementById('snackbar'));

        // Function to show snackbar messages
        function showSnackbar(message, errorLog = '') {
            let messageContent = message;
            if (errorLog) {
                messageContent += `<small>${errorLog}</small>`;
            }
            document.getElementById('snackbarMessage').innerHTML = messageContent;
            document.getElementById('snackbar').style.display = 'block';
            snackbar.show();
        }

        // Password validation and button action
        document.getElementById('loginForm').addEventListener('submit', function(event) {
            event.preventDefault();
            let inputPassword = document.getElementById('password').value;

            // Check if the input matches the stored password
            if (inputPassword === storedPassword) {
                showSnackbar("Access granted!");

                // Replace "Submit" with "Proceed" and add a click action to redirect
                let submitBtn = document.getElementById('submitBtn');
                submitBtn.textContent = "Proceed";
                submitBtn.setAttribute("onclick", "window.location.href='https://joeldom.github.io/style-guide/ux/Case-Study/';");

                // Now, fetch the dynamic password AFTER success
                fetchDynamicPassword();

            } else {
                showSnackbar("Access denied!", "Invalid password attempt at " + new Date().toLocaleString() + "<br>Try again in 5 seconds with COMPANY_NAME");
            }
        });

        // Function to fetch the dynamic password from the JSON file after the initial password is validated
        function fetchDynamicPassword() {
            fetch('https://raw.githubusercontent.com/joeldom/asset/85650484065f940add5dd313e71f76b84ab45822/array/strings.json')
                .then(response => response.json())
                .then(data => {
                    // Update storedPassword with the first element from the array
                    storedPassword = data[0];
                    showSnackbar("Password accepted, you may proceed :)");
                })
                .catch(error => {
                    showSnackbar("Error confirming password", error.message);
                });
        }

        // WARNING !!!
        let clickCount = 0;
        let confirmAttempts = 0;
        let clickTimer;

        // Function to show the warning overlay
        function showWarning() {
            // Check if overlay already exists to prevent duplication
            if (document.querySelector('.overlay')) return;

            // Create overlay with gradient animation
            const overlay = document.createElement('div');
            overlay.className = 'overlay';

            // Centered warning form content
            const warningDiv = document.createElement('div');
            warningDiv.className = 'warning-form';
            warningDiv.innerHTML = `
				<div class="warning"><h1>‚ö†Ô∏è</h1><br/> Warning! <span>Suspicious Activity</span></div>
				<div class="warning-form-content">
					<div class="radio-group">
						<p>Are you human?</p>
						<div class="radio-group-sub">
							<input type="radio" id="yesCheck" name="humanCheck" value="yes" />
							<label for="yesCheck">Yes</label>
							<input type="radio" id="noCheck" name="humanCheck" value="no" />
							<label for="noCheck">No</label>
						</div>
					</div>
					<button id="confirmBtn" disabled data-title="Please answer...">Confirm</button>
				</div>
			`;

            overlay.appendChild(warningDiv);
            document.body.appendChild(overlay);

            const yesCheck = document.getElementById('yesCheck');
            const noCheck = document.getElementById('noCheck');
            const confirmBtn = document.getElementById('confirmBtn');

            // Enable the confirm button only if a radio button is selected
            yesCheck.addEventListener('change', () => {
                confirmBtn.disabled = false;
                confirmBtn.textContent = "Confirm";
                confirmBtn.onclick = () => {
                    document.body.removeChild(overlay); // Removes the overlay from the DOM
                };
            });

            noCheck.addEventListener('change', () => {
                confirmBtn.disabled = false;
                confirmBtn.textContent = "Confirm";
                confirmBtn.onclick = () => modifyForm(warningDiv);
            });
        }

        // Function to modify the warning form after "No" is selected
        function modifyForm(warningDiv) {
            const formContent = warningDiv.querySelector('.warning-form-content');

            // Remove the radio buttons and update the content
            formContent.innerHTML = `
				<p>Please review the information below and acknowledge to proceed:</p>
				<iframe src="terms.html" style="width: 100%; min-width:64vh; height: 30vh; border: none;"></iframe>
				<button id="acknowledgeBtn">Acknowledge</button>
			`;

            const acknowledgeBtn = document.getElementById('acknowledgeBtn');
            acknowledgeBtn.onclick = () => {
                document.body.removeChild(warningDiv.closest('.overlay')); // Remove the overlay
            };
        }

        // Function to track rapid clicks
        function trackClicks() {
            clickCount++;
            clearTimeout(clickTimer); // Reset timer on each click

            // Start a timer to reset clickCount after 2 seconds
            clickTimer = setTimeout(() => {
                clickCount = 0;
            }, 2000);

            // Show warning if clickCount reaches 5 within 2 seconds
            if (clickCount >= 5) {
                showWarning();
                clickCount = 0; // Reset click count after showing warning
            }
        }

        // Event listener for tracking rapid clicks on the page
        document.body.addEventListener('click', trackClicks);

        // Event listener for tracking failed login attempts
        document.getElementById('loginForm').addEventListener('submit', (event) => {
            confirmAttempts++;

            // Show warning if there are 5 failed attempts
            if (confirmAttempts >= 5) {
                event.preventDefault();
                showWarning();
                confirmAttempts = 0; // Reset attempts after showing warning
            }
        });
    </script>


</body>

</html>